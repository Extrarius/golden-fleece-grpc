# ๐ Notes Service

gRPC ัะตัะฒะธั ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะทะฐะผะตัะบะฐะผะธ, ัะตะฐะปะธะทะพะฒะฐะฝะฝัะน ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ **Clean Architecture** ะธ **Protocol Buffers**.

## ๐ ะะฟะธัะฐะฝะธะต

Notes Service โ ััะพ ะฑะฐะทะพะฒัะน ะผะธะบัะพัะตัะฒะธั, ะฟัะตะดะพััะฐะฒะปัััะธะน API ะดะปั ัะพะทะดะฐะฝะธั, ััะตะฝะธั, ะพะฑะฝะพะฒะปะตะฝะธั ะธ ัะดะฐะปะตะฝะธั ะทะฐะผะตัะพะบ. ะกะตัะฒะธั ะธัะฟะพะปัะทัะตั gRPC ะดะปั ะบะพะผะผัะฝะธะบะฐัะธะธ ะธ in-memory ััะฐะฝะธะปะธัะต ะฝะฐ ะพัะฝะพะฒะต `map[string]model.Note` ะดะปั ะดะฐะฝะฝัั.

### ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

- โ ะกะพะทะดะฐะฝะธะต ะทะฐะผะตัะพะบ ั ะทะฐะณะพะปะพะฒะบะพะผ ะธ ัะพะดะตัะถะธะผัะผ
- โ ะะพะปััะตะฝะธะต ะทะฐะผะตัะบะธ ะฟะพ UUID
- โ ะะพะปััะตะฝะธะต ัะฟะธัะบะฐ ะฒัะตั ะทะฐะผะตัะพะบ
- โ ะะฑะฝะพะฒะปะตะฝะธะต ัััะตััะฒัััะธั ะทะฐะผะตัะพะบ
- โ ะฃะดะฐะปะตะฝะธะต ะทะฐะผะตัะพะบ
- โ gRPC reflection ะดะปั ะพัะปะฐะดะบะธ (grpcurl, grpcui)
- โ Graceful shutdown
- โ Clean Architecture ั ัะฐะทะดะตะปะตะฝะธะตะผ ะฝะฐ ัะปะพะธ

## ๐๏ธ ะััะธัะตะบัััะฐ

ะัะพะตะบั ัะปะตะดัะตั ะฟัะธะฝัะธะฟะฐะผ **Clean Architecture** ั ัะฐะทะดะตะปะตะฝะธะตะผ ะฝะฐ ัะปะตะดัััะธะต ัะปะพะธ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      API Layer (gRPC Handlers)          โ
โ      internal/api/grpc/                 โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Service Layer (Business Logic)     โ
โ      internal/service/notes/            โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Repository Layer (Data Access)     โ
โ      internal/repository/memory/        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
notes-service/
โโโ cmd/server/           # ะขะพัะบะฐ ะฒัะพะดะฐ ะฟัะธะปะพะถะตะฝะธั
โโโ internal/
โ   โโโ api/grpc/        # gRPC handlers (ััะฐะฝัะฟะพััะฝัะน ัะปะพะน)
โ   โโโ service/         # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โ   โโโ repository/      # ะะพัััะฟ ะบ ะดะฐะฝะฝัะผ
โ   โโโ model/           # ะะพะผะตะฝะฝัะต ะผะพะดะตะปะธ
โ   โโโ converter/       # ะะพะฝะฒะตััะตัั proto โ domain
โโโ proto/               # Protocol Buffer ะพะฟัะตะดะตะปะตะฝะธั
โโโ pkg/proto/           # ะกะณะตะฝะตัะธัะพะฒะฐะฝะฝัะน Go ะบะพะด ะธะท proto
```

## ๐ ะขัะตะฑะพะฒะฐะฝะธั

### ะะฑัะทะฐัะตะปัะฝัะต

- **Go** 1.25.5 ะธะปะธ ะฒััะต
- **easyp** - ะดะปั ัะฟัะฐะฒะปะตะฝะธั proto ะทะฐะฒะธัะธะผะพัััะผะธ ะธ ะณะตะฝะตัะฐัะธะธ ะบะพะดะฐ

### ะะฟัะธะพะฝะฐะปัะฝัะต (ะดะปั ัะตััะธัะพะฒะฐะฝะธั API)

- **grpcurl** - ะดะปั ัะตััะธัะพะฒะฐะฝะธั gRPC API ะธะท ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ
- **grpcui** - ะดะปั ะธะฝัะตัะฐะบัะธะฒะฝะพะณะพ ัะตััะธัะพะฒะฐะฝะธั ัะตัะตะท ะฒะตะฑ-ะธะฝัะตััะตะนั

### ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

ะะฝััััะผะตะฝัั ะดะปั ัะฐะทัะฐะฑะพัะบะธ ะฑัะดัั ัััะฐะฝะพะฒะปะตะฝั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธ ะฒัะฟะพะปะฝะตะฝะธะธ ะทะฐะดะฐั ะธะท Taskfile:

```bash
task install-tools
```

ะญัะพ ัััะฐะฝะพะฒะธั:
- `easyp` - ะผะตะฝะตะดะถะตั proto ะทะฐะฒะธัะธะผะพััะตะน
- `protoc-gen-go` - ะณะตะฝะตัะฐัะพั Go ะบะพะดะฐ ะดะปั protobuf
- `protoc-gen-go-grpc` - ะณะตะฝะตัะฐัะพั gRPC ะบะพะดะฐ

## ๐ ะะฐะฟััะบ

### ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน Go

```bash
go mod download
```

### ะะตะฝะตัะฐัะธั ะบะพะดะฐ ะธะท proto ัะฐะนะปะพะฒ

```bash
task generate
```

ะญัะฐ ะบะพะผะฐะฝะดะฐ:
1. ะะฑะฝะพะฒะธั proto ะทะฐะฒะธัะธะผะพััะธ ัะตัะตะท `easyp`
2. ะกะณะตะฝะตัะธััะตั Go ะบะพะด ะธะท `.proto` ัะฐะนะปะพะฒ ะฒ `pkg/proto/`

### ะะฐะฟััะบ ัะตัะฒะตัะฐ

#### ะงะตัะตะท Taskfile (ัะตะบะพะผะตะฝะดัะตััั)

```bash
task run
```

#### ะะฐะฟััะผัั ัะตัะตะท Go

```bash
go run cmd/server/main.go
```

#### ะก ะบะฐััะพะผะฝัะผ ะฟะพััะพะผ

ะะพ ัะผะพะปัะฐะฝะธั ัะตัะฒะตั ะทะฐะฟััะบะฐะตััั ะฝะฐ ะฟะพััั `50051`. ะะปั ะธะทะผะตะฝะตะฝะธั ะฟะพััะฐ ะธัะฟะพะปัะทัะนัะต ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั:

```bash
PORT=8080 go run cmd/server/main.go
```

ะธะปะธ

```bash
PORT=8080 task run
```

### ะะฐะฟััะบ ัะตััะพะฒ

```bash
task test
```

ะธะปะธ

```bash
go test ./...
```

## ๐ก API

### Endpoints

ะกะตัะฒะธั ะฟัะตะดะพััะฐะฒะปัะตั ัะปะตะดัััะธะต gRPC ะผะตัะพะดั:

| ะะตัะพะด | ะะฟะธัะฐะฝะธะต | Request | Response |
|-------|----------|---------|----------|
| `CreateNote` | ะกะพะทะดะฐัั ะฝะพะฒัั ะทะฐะผะตัะบั | `CreateNoteRequest` | `CreateNoteResponse` |
| `GetNote` | ะะพะปััะธัั ะทะฐะผะตัะบั ะฟะพ UUID | `GetNoteRequest` | `GetNoteResponse` |
| `ListNotes` | ะะพะปััะธัั ัะฟะธัะพะบ ะฒัะตั ะทะฐะผะตัะพะบ | `ListNotesRequest` | `ListNotesResponse` |
| `UpdateNote` | ะะฑะฝะพะฒะธัั ัััะตััะฒััััั ะทะฐะผะตัะบั | `UpdateNoteRequest` | `UpdateNoteResponse` |
| `DeleteNote` | ะฃะดะฐะปะธัั ะทะฐะผะตัะบั ะฟะพ UUID | `DeleteNoteRequest` | `DeleteNoteResponse` |

### ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

#### ะงะตัะตะท grpcurl

##### ะกะฟะธัะพะบ ะดะพัััะฟะฝัั ะผะตัะพะดะพะฒ

```bash
grpcurl -plaintext localhost:50051 list
```

##### ะกะฟะธัะพะบ ะผะตัะพะดะพะฒ ะบะพะฝะบัะตัะฝะพะณะพ ัะตัะฒะธัะฐ

```bash
grpcurl -plaintext localhost:50051 list notes.v1.NotesService
```

##### ะกะพะทะดะฐะฝะธะต ะทะฐะผะตัะบะธ

```bash
grpcurl -plaintext -d '{
  "title": "ะะพั ะฟะตัะฒะฐั ะทะฐะผะตัะบะฐ",
  "content": "ะญัะพ ัะพะดะตัะถะธะผะพะต ะทะฐะผะตัะบะธ"
}' localhost:50051 notes.v1.NotesService/CreateNote
```

ะัะธะผะตั ะพัะฒะตัะฐ:

```json
{
  "note": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "title": "ะะพั ะฟะตัะฒะฐั ะทะฐะผะตัะบะฐ",
    "content": "ะญัะพ ัะพะดะตัะถะธะผะพะต ะทะฐะผะตัะบะธ",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  }
}
```

##### ะะพะปััะตะฝะธะต ะทะฐะผะตัะบะธ ะฟะพ ID

```bash
grpcurl -plaintext -d '{
  "id": "550e8400-e29b-41d4-a716-446655440000"
}' localhost:50051 notes.v1.NotesService/GetNote
```

##### ะะพะปััะตะฝะธะต ัะฟะธัะบะฐ ะฒัะตั ะทะฐะผะตัะพะบ

```bash
grpcurl -plaintext -d '{}' localhost:50051 notes.v1.NotesService/ListNotes
```

ะธะปะธ ะฟัะพัะต:

```bash
grpcurl -plaintext localhost:50051 notes.v1.NotesService/ListNotes
```

ะัะธะผะตั ะพัะฒะตัะฐ:

```json
{
  "notes": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "title": "ะะพั ะฟะตัะฒะฐั ะทะฐะผะตัะบะฐ",
      "content": "ะญัะพ ัะพะดะตัะถะธะผะพะต ะทะฐะผะตัะบะธ",
      "created_at": "2024-01-15T10:30:00Z",
      "updated_at": "2024-01-15T10:30:00Z"
    },
    {
      "id": "660e8400-e29b-41d4-a716-446655440001",
      "title": "ะัะพัะฐั ะทะฐะผะตัะบะฐ",
      "content": "ะััะณะพะต ัะพะดะตัะถะธะผะพะต",
      "created_at": "2024-01-15T11:00:00Z",
      "updated_at": "2024-01-15T11:00:00Z"
    }
  ]
}
```

##### ะะฑะฝะพะฒะปะตะฝะธะต ะทะฐะผะตัะบะธ

```bash
grpcurl -plaintext -d '{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "title": "ะะฑะฝะพะฒะปะตะฝะฝัะน ะทะฐะณะพะปะพะฒะพะบ",
  "content": "ะะฑะฝะพะฒะปะตะฝะฝะพะต ัะพะดะตัะถะธะผะพะต"
}' localhost:50051 notes.v1.NotesService/UpdateNote
```

##### ะฃะดะฐะปะตะฝะธะต ะทะฐะผะตัะบะธ

```bash
grpcurl -plaintext -d '{
  "id": "550e8400-e29b-41d4-a716-446655440000"
}' localhost:50051 notes.v1.NotesService/DeleteNote
```

ะัะธ ััะฟะตัะฝะพะผ ัะดะฐะปะตะฝะธะธ ะพัะฒะตั ะฑัะดะตั ะฟััััะผ, ััะฐััั `OK`.

#### ะงะตัะตะท grpcui (ะฒะตะฑ-ะธะฝัะตััะตะนั)

1. ะฃััะฐะฝะพะฒะธัะต grpcui:
   ```bash
   go install github.com/fullstorydev/grpcui/cmd/grpcui@latest
   ```

2. ะะฐะฟัััะธัะต grpcui:
   ```bash
   grpcui -plaintext localhost:50051
   ```

3. ะัะบัะพะนัะต ะฑัะฐัะทะตั ะฟะพ ะฐะดัะตัั, ะบะพัะพััะน ะฟะพะบะฐะถะตั grpcui (ะพะฑััะฝะพ `http://localhost:52485`)

4. ะัะฑะตัะธัะต ะผะตัะพะด ะธ ะทะฐะฟะพะปะฝะธัะต ะฟะฐัะฐะผะตััั ัะตัะตะท ัะดะพะฑะฝัะน ะฒะตะฑ-ะธะฝัะตััะตะนั

## ๐ง ะะพะผะฐะฝะดั Taskfile

ะัะพะตะบั ะธัะฟะพะปัะทัะตั [Taskfile](https://taskfile.dev/) ะดะปั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ ะทะฐะดะฐั:

| ะะพะผะฐะฝะดะฐ | ะะฟะธัะฐะฝะธะต |
|---------|----------|
| `task install-tools` | ะฃััะฐะฝะพะฒะบะฐ ะธะฝััััะผะตะฝัะพะฒ ัะฐะทัะฐะฑะพัะบะธ (easyp, protoc plugins) |
| `task generate` | ะะตะฝะตัะฐัะธั Go ะบะพะดะฐ ะธะท proto ัะฐะนะปะพะฒ |
| `task lint` | ะะธะฝัะธะฝะณ proto ัะฐะนะปะพะฒ |
| `task run` | ะะฐะฟััะบ ัะตัะฒะตัะฐ |
| `task test` | ะะฐะฟััะบ ัะตััะพะฒ |
| `task clean` | ะัะธััะบะฐ ัะณะตะฝะตัะธัะพะฒะฐะฝะฝัั ัะฐะนะปะพะฒ ะธ ะฐััะตัะฐะบัะพะฒ |

## ๐ ะัะธะผะตัะฐะฝะธั

### ะฅัะฐะฝะธะปะธัะต ะดะฐะฝะฝัั

ะ ัะตะบััะตะน ัะตะฐะปะธะทะฐัะธะธ ะธัะฟะพะปัะทัะตััั **in-memory ััะฐะฝะธะปะธัะต** ะฝะฐ ะพัะฝะพะฒะต `map[string]model.Note` (`internal/repository/memory`). ะัะต ะดะฐะฝะฝัะต ััะฐะฝัััั ะฒ ะฟะฐะผััะธ ะฟัะพัะตััะฐ ะฒ ะฒะธะดะต map ะธ ัะตัััััั ะฟัะธ ะฟะตัะตะทะฐะฟััะบะต ัะตัะฒะตัะฐ.

ะะปั production ะธัะฟะพะปัะทะพะฒะฐะฝะธั ัะตะบะพะผะตะฝะดัะตััั ะทะฐะผะตะฝะธัั ะฝะฐ ะฟะตััะธััะตะฝัะฝะพะต ััะฐะฝะธะปะธัะต (PostgreSQL, MongoDB ะธ ั.ะด.).

### Graceful Shutdown

ะกะตัะฒะตั ะฟะพะดะดะตัะถะธะฒะฐะตั graceful shutdown ะฟัะธ ะฟะพะปััะตะฝะธะธ ัะธะณะฝะฐะปะพะฒ `SIGINT` ะธะปะธ `SIGTERM`. ะัะธ ะฟะพะปััะตะฝะธะธ ัะธะณะฝะฐะปะฐ ัะตัะฒะตั:
1. ะัะตะบัะฐัะฐะตั ะฟัะธะตะผ ะฝะพะฒัั ะทะฐะฟัะพัะพะฒ
2. ะะฐะฒะตััะฐะตั ะพะฑัะฐะฑะพัะบั ะฐะบัะธะฒะฝัั ะทะฐะฟัะพัะพะฒ (ะดะพ 5 ัะตะบัะฝะด)
3. ะะพััะตะบัะฝะพ ะทะฐะบััะฒะฐะตั ะฒัะต ัะพะตะดะธะฝะตะฝะธั

### gRPC Reflection

ะกะตัะฒะตั ะฒะบะปััะฐะตั ะฟะพะดะดะตัะถะบั gRPC reflection, ััะพ ะฟะพะทะฒะพะปัะตั ะธัะฟะพะปัะทะพะฒะฐัั ะธะฝััััะผะตะฝัั ะฒัะพะดะต `grpcurl` ะธ `grpcui` ะฑะตะท ะฝะตะพะฑัะพะดะธะผะพััะธ ะธะผะตัั `.proto` ัะฐะนะปั ะปะพะบะฐะปัะฝะพ.

## ๐ ะะธัะตะฝะทะธั

ะัะพะตะบั ัะพะทะดะฐะฝ ะฒ ะพะฑัะฐะทะพะฒะฐัะตะปัะฝัั ัะตะปัั.
